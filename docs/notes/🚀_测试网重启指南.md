# 🚀 测试网重启指南 - Day 2

## 问题解决
由于PowerShell编码问题，我们创建了Windows批处理文件来启动测试网。

## 快速启动步骤

### 方法1: 使用Windows批处理文件（推荐）

1. **双击运行** `start_testnet_windows.bat`
   - 这会自动停止旧进程
   - 重新编译项目
   - 启动测试网服务器
   - 启动1周自动化测试

2. **检查状态** 双击运行 `test_server_status.bat`
   - 检查服务器是否正常运行
   - 测试API端点

### 方法2: 手动启动（如果批处理文件有问题）

1. **停止旧进程**
   ```cmd
   netstat -ano | findstr :8080
   taskkill /F /PID [进程ID]
   ```

2. **重新编译**
   ```cmd
   cargo build --release
   ```

3. **启动服务器**
   ```cmd
   start_testnet.sh
   ```

4. **启动自动化测试**
   ```cmd
   week_automated_test.sh
   ```

## 自动化测试功能

### 测试内容
- ✅ 健康检查
- ✅ 钱包创建和管理
- ✅ 余额查询（已修复）
- ✅ 交易历史查询
- ✅ 网络状态检查

### 测试配置
- **测试间隔**: 30分钟
- **测试时长**: 7天
- **日志目录**: `logs/week_test/`
- **API地址**: `http://localhost:8080`

## 验证修复

### 余额查询修复
Day 1的问题已修复：
- ✅ 修复了 `src/main.rs` 中的区块链配置加载
- ✅ 添加了默认网络配置
- ✅ 确保区块链客户端正确初始化

### 测试命令
```bash
# 健康检查
curl http://localhost:8080/health

# 创建钱包
curl -X POST http://localhost:8080/wallets \
  -H "Authorization: Bearer test-api-key-12345" \
  -H "Content-Type: application/json" \
  -d '{"name": "test_wallet", "description": "测试钱包"}'

# 查询余额
curl -H "Authorization: Bearer test-api-key-12345" \
  http://localhost:8080/wallets/[钱包地址]/balance
```

## 监控和日志

### 实时监控
- 服务器日志: 控制台输出
- 测试日志: `logs/week_test/automated_test_*.log`
- 错误日志: 检查控制台错误信息

### 关键指标
- 服务器响应时间
- API成功率
- 余额查询准确性
- 交易处理状态

## 故障排除

### 常见问题
1. **端口被占用**: 运行 `test_server_status.bat` 检查
2. **编译失败**: 检查Rust环境，运行 `cargo clean && cargo build`
3. **API无响应**: 检查服务器日志，重启服务器

### 联系支持
如果遇到问题，请提供：
- 错误日志
- 服务器状态
- 测试结果

## 下一步计划

### 1周测试完成后
- 📊 分析测试报告
- 🔧 修复发现的问题
- 🚀 准备生产环境部署
- 🎯 优化性能指标

---

**🎉 现在请双击运行 `start_testnet_windows.bat` 开始1周自动化测试！**
