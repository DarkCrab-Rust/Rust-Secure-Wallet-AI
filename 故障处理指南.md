# ğŸ”§ å‰åç«¯è”è°ƒæ•…éšœå¤„ç†æŒ‡å—

> **å‰ç«¯å›ºå®šç«¯å£**: `3010`  
> **åç«¯å›ºå®šç«¯å£**: `8888`

---

## ğŸ¯ å¿«é€Ÿè¯Šæ–­æµç¨‹

```
å‰ç«¯æ— æ³•è¿æ¥åç«¯
    â†“
1. æ£€æŸ¥CORSé…ç½® â†’ æ˜¯å¦å…è®¸ http://localhost:3010?
    â†“
2. æ£€æŸ¥API Key â†’ æ˜¯å¦æ­£ç¡®é…ç½®?
    â†“
3. æ£€æŸ¥ç«¯å£å†²çª â†’ 3010ç«¯å£æ˜¯å¦è¢«å ç”¨?
    â†“
4. æ£€æŸ¥åç«¯çŠ¶æ€ â†’ 8888ç«¯å£æ˜¯å¦æ­£å¸¸è¿è¡Œ?
```

---

## âŒ æ•…éšœ1: CORSé”™è¯¯

### ğŸ” é”™è¯¯è¡¨ç°

æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º:

```
Access to XMLHttpRequest at 'http://localhost:8888/api/wallets' 
from origin 'http://localhost:3010' has been blocked by CORS policy
```

æˆ–:

```
No 'Access-Control-Allow-Origin' header is present
```

---

### âœ… è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1: é…ç½®åç«¯å…è®¸3010ç«¯å£ (æ¨è)

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Rust-Blockchain-Secure-Wallet"

# é…ç½®CORSå…è®¸3010
export CORS_ALLOW_ORIGIN="http://localhost:3010"

# é‡å¯åç«¯
bash restart_server.sh
```

#### æ–¹æ¡ˆ2: åŒæ—¶å…è®¸3000å’Œ3010 (å¼€å‘ç¯å¢ƒæ¨è)

```bash
# åŒæ—¶æ”¯æŒåç«¯æµ‹è¯•(3000)å’Œå‰ç«¯å¼€å‘(3010)
export CORS_ALLOW_ORIGIN="http://localhost:3000,http://localhost:3010"

bash restart_server.sh
```

#### æ–¹æ¡ˆ3: ä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬

```bash
bash start_fullstack.sh
# é€‰æ‹© "2. å¯åŠ¨åç«¯+å‰ç«¯"
# ä¼šè‡ªåŠ¨é…ç½®CORSä¸º3010
```

---

### ğŸ” éªŒè¯CORSé…ç½®

```bash
# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
bash view_server_logs.sh

# åº”è¯¥çœ‹åˆ°:
# INFO: CORS configured to allow origin: http://localhost:3010
```

æˆ–è€…æµ‹è¯•CORSè¯·æ±‚:

```bash
curl -v -X OPTIONS http://localhost:8888/api/health \
  -H "Origin: http://localhost:3010" \
  -H "Access-Control-Request-Method: GET"

# åº”è¯¥è¿”å›:
# < Access-Control-Allow-Origin: http://localhost:3010
```

---

## âŒ æ•…éšœ2: API Keyè®¤è¯å¤±è´¥

### ğŸ” é”™è¯¯è¡¨ç°

æµè§ˆå™¨æ§åˆ¶å°æˆ–ç½‘ç»œè¯·æ±‚æ˜¾ç¤º:

```json
{
  "error": "Unauthorized",
  "code": "AUTH_FAILED"
}
```

æˆ–å‰ç«¯æ˜¾ç¤º:
```
åŠ è½½é’±åŒ…åˆ—è¡¨å¤±è´¥
```

---

### âœ… è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1: åœ¨æµè§ˆå™¨æ§åˆ¶å°è®¾ç½®API Key (æ¨è)

1. **æ‰“å¼€æµè§ˆå™¨**: è®¿é—® `http://localhost:3010`
2. **æ‰“å¼€æ§åˆ¶å°**: æŒ‰ `F12` é”®
3. **æ‰§è¡Œä»¥ä¸‹å‘½ä»¤**:

```javascript
// è®¾ç½®API Key
localStorage.setItem('api_key', 'testnet_api_key_51a69b550a2c4149');

// è®¾ç½®API URL
localStorage.setItem('api_url', 'http://localhost:8888');

// åˆ·æ–°é¡µé¢
location.reload();
```

---

#### æ–¹æ¡ˆ2: é…ç½®å‰ç«¯ç¯å¢ƒæ–‡ä»¶

åˆ›å»º `Wallet front-end/blockchain-wallet-ui/.env.local`:

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Wallet front-end/blockchain-wallet-ui"

cat > .env.local << 'EOF'
PORT=3010
REACT_APP_API_URL=http://localhost:8888
REACT_APP_API_KEY=testnet_api_key_51a69b550a2c4149
REACT_APP_DEFAULT_NETWORK=eth
REACT_APP_ENABLE_TESTNET=true
REACT_APP_ENV=development
EOF

# é‡å¯å‰ç«¯
npm start
```

æˆ–ä½¿ç”¨è„šæœ¬:

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Rust-Blockchain-Secure-Wallet"
bash create_frontend_env.sh
```

---

#### æ–¹æ¡ˆ3: æ£€æŸ¥å‰ç«¯ä»£ç 

ç¡®è®¤ `src/services/api.ts` ä¸­çš„API Keyé…ç½®:

```typescript
const API_KEY = localStorage.getItem('api_key') || 
                process.env.REACT_APP_API_KEY || 
                'testnet_api_key_51a69b550a2c4149';
```

---

### ğŸ” éªŒè¯API Key

#### åç«¯æµ‹è¯•:

```bash
# æ­£ç¡®çš„API Key
curl -H "Authorization: testnet_api_key_51a69b550a2c4149" \
  http://localhost:8888/api/wallets

# åº”è¯¥è¿”å›é’±åŒ…åˆ—è¡¨ (å¯èƒ½æ˜¯ç©ºæ•°ç»„)
```

#### å‰ç«¯æµ‹è¯•:

1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12)
2. åˆ‡æ¢åˆ° **Network** æ ‡ç­¾
3. åˆ·æ–°é¡µé¢
4. æŸ¥çœ‹ `/api/wallets` è¯·æ±‚
5. æ£€æŸ¥ **Request Headers** ä¸­çš„ `Authorization` å­—æ®µ

åº”è¯¥çœ‹åˆ°:
```
Authorization: testnet_api_key_51a69b550a2c4149
```

---

## âŒ æ•…éšœ3: ç«¯å£å†²çª

### ğŸ” é”™è¯¯è¡¨ç°

å¯åŠ¨å‰ç«¯æ—¶æ˜¾ç¤º:

```
? Something is already running on port 3010.
```

æˆ–:

```
Error: listen EADDRINUSE: address already in use :::3010
```

---

### âœ… è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1: æ€æ­»å ç”¨è¿›ç¨‹ (æ¨è)

```bash
# æŸ¥æ‰¾å ç”¨3010ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :3010

# è¾“å‡ºç¤ºä¾‹:
# TCP    0.0.0.0:3010    0.0.0.0:0    LISTENING    12345

# æ€æ­»è¿›ç¨‹ (12345æ˜¯PID)
taskkill /F /PID 12345
```

#### æ–¹æ¡ˆ2: ä¸€é”®æ¸…ç†è„šæœ¬

```bash
# åˆ›å»ºæ¸…ç†è„šæœ¬
cat > kill_port_3010.bat << 'EOF'
@echo off
echo æ­£åœ¨æŸ¥æ‰¾å ç”¨3010ç«¯å£çš„è¿›ç¨‹...
for /f "tokens=5" %%a in ('netstat -ano ^| findstr :3010') do (
    echo æ­£åœ¨æ€æ­»è¿›ç¨‹ %%a
    taskkill /F /PID %%a
)
echo å®Œæˆ!
EOF

# è¿è¡Œè„šæœ¬
./kill_port_3010.bat
```

---

### ğŸ” éªŒè¯ç«¯å£çŠ¶æ€

```bash
# æ£€æŸ¥3010ç«¯å£
netstat -ano | findstr :3010

# å¦‚æœæ²¡æœ‰è¾“å‡º,è¯´æ˜ç«¯å£å·²é‡Šæ”¾
```

---

## âŒ æ•…éšœ4: åç«¯æœªå¯åŠ¨

### ğŸ” é”™è¯¯è¡¨ç°

å‰ç«¯æ˜¾ç¤º:
```
Network Error
Failed to fetch
```

æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º:
```
GET http://localhost:8888/api/wallets net::ERR_CONNECTION_REFUSED
```

---

### âœ… è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1: å¯åŠ¨åç«¯

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Rust-Blockchain-Secure-Wallet"

# é…ç½®CORSä¸º3010
export CORS_ALLOW_ORIGIN="http://localhost:3010"

# å¯åŠ¨åç«¯
bash restart_server.sh
```

#### æ–¹æ¡ˆ2: æ£€æŸ¥åç«¯çŠ¶æ€

```bash
# æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€
bash manage_server.sh
# é€‰æ‹© "1. æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€"

# æˆ–ç›´æ¥æ£€æŸ¥8888ç«¯å£
netstat -ano | findstr :8888
```

#### æ–¹æ¡ˆ3: æŸ¥çœ‹åç«¯æ—¥å¿—

```bash
bash view_server_logs.sh
# é€‰æ‹© "1. æŸ¥çœ‹æœ€è¿‘æ—¥å¿—"
```

---

### ğŸ” éªŒè¯åç«¯çŠ¶æ€

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8888/api/health

# åº”è¯¥è¿”å›:
# {"status":"ok"}
```

---

## ğŸ¯ å®Œæ•´å¯åŠ¨æµç¨‹ (æ¨è)

### æ–¹å¼1: ä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Rust-Blockchain-Secure-Wallet"

bash start_fullstack.sh
# é€‰æ‹© "2. å¯åŠ¨åç«¯+å‰ç«¯"
```

**ä¼˜ç‚¹**:
- âœ… è‡ªåŠ¨é…ç½®CORSä¸º3010
- âœ… è‡ªåŠ¨åˆ›å»ºå‰ç«¯ç¯å¢ƒé…ç½®
- âœ… è‡ªåŠ¨å¯åŠ¨å‰åç«¯
- âœ… æä¾›æ¸…æ™°çš„é…ç½®æç¤º

---

### æ–¹å¼2: æ‰‹åŠ¨å¯åŠ¨

#### æ­¥éª¤1: å¯åŠ¨åç«¯

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Rust-Blockchain-Secure-Wallet"

# é…ç½®CORS
export CORS_ALLOW_ORIGIN="http://localhost:3010"

# å¯åŠ¨åç«¯
bash restart_server.sh
```

#### æ­¥éª¤2: é…ç½®å‰ç«¯

```bash
cd "C:/Users/plant/Desktop/RuståŒºå—é“¾/Wallet front-end/blockchain-wallet-ui"

# åˆ›å»ºç¯å¢ƒé…ç½®
cat > .env.local << 'EOF'
PORT=3010
REACT_APP_API_URL=http://localhost:8888
REACT_APP_API_KEY=testnet_api_key_51a69b550a2c4149
EOF
```

#### æ­¥éª¤3: å¯åŠ¨å‰ç«¯

```bash
npm start
```

#### æ­¥éª¤4: é…ç½®æµè§ˆå™¨

1. æ‰“å¼€ `http://localhost:3010`
2. æŒ‰ `F12` æ‰“å¼€æ§åˆ¶å°
3. æ‰§è¡Œ:

```javascript
localStorage.setItem('api_key', 'testnet_api_key_51a69b550a2c4149');
localStorage.setItem('api_url', 'http://localhost:8888');
location.reload();
```

---

## ğŸ“‹ æ•…éšœæ’æŸ¥æ£€æŸ¥æ¸…å•

åœ¨æŠ¥å‘Šé—®é¢˜å‰,è¯·ä¾æ¬¡æ£€æŸ¥:

- [ ] **åç«¯æ˜¯å¦è¿è¡Œ?**
  ```bash
  netstat -ano | findstr :8888
  ```

- [ ] **CORSæ˜¯å¦é…ç½®ä¸º3010?**
  ```bash
  bash view_server_logs.sh
  # æŸ¥æ‰¾: "CORS configured to allow origin: http://localhost:3010"
  ```

- [ ] **å‰ç«¯æ˜¯å¦åœ¨3010ç«¯å£?**
  ```bash
  netstat -ano | findstr :3010
  ```

- [ ] **API Keyæ˜¯å¦æ­£ç¡®?**
  - æµè§ˆå™¨F12 â†’ Network â†’ æŸ¥çœ‹è¯·æ±‚å¤´
  - åº”è¯¥æ˜¯: `Authorization: testnet_api_key_51a69b550a2c4149`

- [ ] **æµè§ˆå™¨localStorageæ˜¯å¦é…ç½®?**
  - æµè§ˆå™¨F12 â†’ Console â†’ æ‰§è¡Œ:
  ```javascript
  console.log(localStorage.getItem('api_key'));
  console.log(localStorage.getItem('api_url'));
  ```

---

## ğŸ” é«˜çº§è°ƒè¯•

### æŸ¥çœ‹å®Œæ•´è¯·æ±‚æµç¨‹

1. **æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·** (F12)
2. **åˆ‡æ¢åˆ°Networkæ ‡ç­¾**
3. **åˆ·æ–°é¡µé¢**
4. **ç‚¹å‡»å¤±è´¥çš„è¯·æ±‚**
5. **æŸ¥çœ‹ä»¥ä¸‹ä¿¡æ¯**:

#### Request Headers (è¯·æ±‚å¤´)
```
Authorization: testnet_api_key_51a69b550a2c4149
Origin: http://localhost:3010
```

#### Response Headers (å“åº”å¤´)
```
Access-Control-Allow-Origin: http://localhost:3010
```

#### Response Body (å“åº”å†…å®¹)
```json
{
  "error": "Unauthorized",
  "code": "AUTH_FAILED"
}
```

---

### ä½¿ç”¨curlæµ‹è¯•åç«¯

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8888/api/health

# æµ‹è¯•é’±åŒ…åˆ—è¡¨ (éœ€è¦API Key)
curl -H "Authorization: testnet_api_key_51a69b550a2c4149" \
  http://localhost:8888/api/wallets

# æµ‹è¯•CORSé¢„æ£€
curl -v -X OPTIONS http://localhost:8888/api/health \
  -H "Origin: http://localhost:3010" \
  -H "Access-Control-Request-Method: GET"
```

---

## ğŸ“ ä»ç„¶æ— æ³•è§£å†³?

å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜,è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯:

1. **åç«¯çŠ¶æ€**:
   ```bash
   bash manage_server.sh
   # é€‰æ‹© "1. æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€"
   ```

2. **åç«¯æ—¥å¿—**:
   ```bash
   bash view_server_logs.sh
   # é€‰æ‹© "1. æŸ¥çœ‹æœ€è¿‘æ—¥å¿—"
   ```

3. **å‰ç«¯ç«¯å£**:
   ```bash
   netstat -ano | findstr :3010
   ```

4. **æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯**:
   - æŒ‰F12æ‰“å¼€æ§åˆ¶å°
   - æˆªå›¾Consoleå’ŒNetworkæ ‡ç­¾çš„é”™è¯¯ä¿¡æ¯

5. **CORSé…ç½®**:
   ```bash
   echo $CORS_ALLOW_ORIGIN
   ```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- `å¤šCORSæºé…ç½®è¯´æ˜.md` - CORSå¤šæºé…ç½®
- `CORSé…ç½®è¯´æ˜.md` - CORSè¯¦ç»†è¯´æ˜
- `åç«¯æµ‹è¯•æŒ‡å—.md` - åç«¯æµ‹è¯•æ–¹æ³•
- `è„šæœ¬ä½¿ç”¨æ‰‹å†Œ.md` - è„šæœ¬ä½¿ç”¨è¯´æ˜

---

**ç¥ä½ å¼€å‘é¡ºåˆ©!** ğŸš€

